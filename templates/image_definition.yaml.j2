# Generated by ubuntu-image-builder
# Image definition for {{ hostname }}

name: "ubuntu-server-{{ hostname }}"
display-name: "Ubuntu Server {{ hostname }}"
revision: 1
architecture: {{ model.architecture }}
series: {{ model.get("series", "noble") }}
class: preinstalled
kernel: {{ model.kernel }}

gadget:
  url: "https://github.com/canonical/{{ model.gadget }}-gadget.git"
  branch: classic
  type: git

rootfs:
  tarball:
    url: "file:///workspace/base/ubuntu-base-24.04.3-base-{{ model.architecture }}.tar.gz"

customization:
  cloud-init:
    meta-data: |
      {{ meta_data | indent(6, false) }}
    user-data: |
      {{ user_data | indent(6, false) }}
    network-config: |
      {{ network_config | indent(6, false) }}

  fstab:
    - label: "writable"
      mountpoint: "/"
      filesystem-type: "ext4"
      dump: false
      fsck-order: 1
    - label: "system-boot"
      mountpoint: "/boot/firmware"
      filesystem-type: "vfat"
      mount-options: "defaults"
      dump: false
      fsck-order: 1
artifacts:
  img:
    - name: "ubuntu-noble-preinstalled-server-{{ model.architecture }}+{{ model.shortname }}-{{ hostname }}.img"
      volume: "{{ volume }}"
  manifest:
    name: "ubuntu-noble-preinstalled-server-{{ model.architecture }}+{{ model.shortname }}-{{ hostname }}.manifest"